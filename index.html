<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>CryptoSnakes</title>

    <script src="src/js/utils.js"></script>
    <script type="text/javascript" src="./src/js/abi/snakeCreatorABI.js"></script>
    <script type="text/javascript" src="./src/js/abi/SnakeReproductionABI.js"></script>
    <script type="text/javascript" src="./src/js/external/web3.min.js"></script>
    <script type="text/javascript" src="./src/js/snakeCreator.js"></script>
    <script type="text/javascript" src="./src/js/SnakeReproduction.js"></script>
    <script src="src/js/external/notify.js"></script>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/snake.css">
    <link rel="stylesheet" href="css/notify.css">

</head>

<body>
<div id="backdrop"></div>
<div id="notify"></div>

<div id="pairingDialog">
    <h1>Pairing two snake:</h1>
    <h3><span id="snakeOne"> </span></h3>
    <h3>&</h3>
    <h3> <span id="snakeTwo"> </span></h3>
    <div class="dialog-actions">
        <button type="button" class="btn-cancel" onclick="closeDialog()">Cancel</button>
        <button type="button" class="btn-confirm" onclick="pairSnakes(pairingSnakes[0], pairingSnakes[1])"
                id="pairingConfirm">Confirm
        </button>
    </div>
</div>

<div style="text-align: center; padding-bottom: 30px;">
    <h1>CryptoSnake</h1>
</div>

<div>
    <div id="createBox">
        <h4>Create New Snake</h4>
        <label for="snakeInputName">Snake Name: </label>
        <input id="snakeInputName" type="text" name="snakeInputName" class="form-control">

        <button id="createSnake" type="button" class="button" onclick="createPayedSnake()">create
            snake
        </button>
        <button id="createInitalSnake" style="display: none" type="button" class="button" onclick="createInitialSnake()">
            create
            Inital Snake
        </button>
    </div>

    <div id="sendSnakeBox">
        <h4>Send Snake</h4>
        <label for="snakeInputName">Snake ID </label>
        <input id="snakeInputID" type="text" name="snakeInputName" class="form-control">

        <button id="sendSnake" type="button" class="button" onclick="">
            Send
        </button>
    </div>
</div>
<button id="approveSnake" type="button" class="button" onclick="">Approve recieved Snake
</button>


<div id="snakesview">
    <p style="float: left; text-align:left; width:33.3333%;">
        Snakes: <span id="snakeamount">0</span>
    </p>

    <h3 style="float: left; text-align:center; width:33.3333%;">
        Your Snakes
    </h3>

    <p style="float: left; text-align:right; width:33.3333%; cursor: pointer " onclick="showAllSnakes()">
        Refresh list <span style="font-size: 2em">ðŸ—˜
     </span>
    </p>

    <div id="snakes"></div>

</div>

<script>
    let cryptoSnakes;
    let userAccount;

    const startApp = () => {
        const cryptoSnakesAddress = "0x9bd160424d0469CA14288E636c2e94080Dafc6Cb";
        cryptoSnakes = new window.web3.eth.Contract(snakeReproductionABI, cryptoSnakesAddress);

        window.web3.eth.getAccounts((err, res) => {
            console.log("user account: " + res[0])
            userAccount = res[0];
            startDisplay();

        });
    }

    const startDisplay = async () => {
        await showAllSnakes();
        await initalSnakeCheck();
    }

    window.addEventListener('load', () => {
        if (window.ethereum) {
            window.web3 = new Web3(window.ethereum);
            window.ethereum.enable();
            console.log("Web3 is found")
        } else {
            console.log("Web3 is NOT found !!!")
        }
        startApp()
    })

    const nameInputField= document.getElementById("snakeInputName");
    const dialog = document.getElementById('pairingDialog');
    const backdrop = document.getElementById('backdrop');
</script>

</body>
</html>